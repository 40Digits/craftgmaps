(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

/* global google */

window.googleMapify = function googleMapify(formattedAddressId, mapId, latId, lngId, streetId, cityId, stateId, countryId, zipId, defaultLat, defaultLng) {
  var formattedAddressEl = document.getElementById(formattedAddressId);
  var mapEl = document.getElementById(mapId);
  var latEl = document.getElementById(latId);
  var lngEl = document.getElementById(lngId);
  var streetEl = document.getElementById(streetId);
  var cityEl = document.getElementById(cityId);
  var stateEl = document.getElementById(stateId);
  var countryEl = document.getElementById(countryId);
  var zipEl = document.getElementById(zipId);
  var geocoder = new google.maps.Geocoder();
  var componentForm = {
    street_number: 'short_name',
    route: 'long_name',
    locality: 'long_name',
    administrative_area_level_1: 'short_name',
    country: 'long_name',
    postal_code: 'short_name'
  };
  var autocomplete = void 0;
  var mapCenter = void 0;
  var zoom = void 0;

  if (!!latEl.value && !!lngEl.value) {
    mapCenter = {
      lat: parseFloat(latEl.value),
      lng: parseFloat(lngEl.value)
    };
    zoom = 12;
  } else {
    mapCenter = {
      lat: parseFloat(defaultLat),
      lng: parseFloat(defaultLng)
    };
    zoom = 4;
  }

  var map = new google.maps.Map(mapEl, {
    center: mapCenter,
    zoom: zoom
  });

  var marker = new google.maps.Marker({
    map: map,
    draggable: true,
    position: mapCenter
  });

  var updateValues = function updateValues(lat, lng, addressComponents) {
    latEl.value = lat;
    lngEl.value = lng;

    if (!!addressComponents) {
      streetEl.value = !!addressComponents.street_number ? addressComponents.street_number : '';
      streetEl.value += !!addressComponents.route ? ' ' + addressComponents.route : '';
      cityEl.value = !!addressComponents.locality ? addressComponents.locality : '';
      stateEl.value = !!addressComponents.administrative_area_level_1 ? addressComponents.administrative_area_level_1 : '';
      countryEl.value = !!addressComponents.country ? addressComponents.country : '';
      zipEl.value = !!addressComponents.postal_code ? addressComponents.postal_code : '';
    }
  };

  var geocodeResults = function geocodeResults(results, status, givenLocation) {
    if (status === google.maps.GeocoderStatus.OK && !!results[0]) {
      var result = results[0];
      var location = !!givenLocation ? givenLocation : result.geometry.location;

      map.fitBounds(result.geometry.viewport);
      map.setCenter(location);
      marker.setPosition(location);

      updateValues(location.lat(), location.lng());
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  };

  var onPredictionSelection = function onPredictionSelection() {
    var place = autocomplete.getPlace();
    var addressComponents = {};

    // Get each component of the address from the place details
    // and fill the corresponding field on the form.
    for (var i = 0; i < place.address_components.length; i++) {
      var addressType = place.address_components[i].types[0];
      if (componentForm[addressType]) {
        var val = place.address_components[i][componentForm[addressType]];
        addressComponents[addressType] = val;
      }
    }

    updateValues(place.geometry.location.lat(), place.geometry.location.lng(), addressComponents);
    console.log(addressComponents);

    map.setCenter(place.geometry.location);
    map.setZoom(15);
    marker.setPosition(place.geometry.location);
  };

  var initAutocomplete = function initAutocomplete() {
    // Create the autocomplete object, restricting the search to geographical location types.
    autocomplete = new google.maps.places.Autocomplete(formattedAddressEl, { types: ['geocode'] });

    // When the user selects an address from the dropdown, populate the address fields in the form.
    autocomplete.addListener('place_changed', onPredictionSelection);
  };

  google.maps.event.addListener(marker, 'dragend', function () {
    geocoder.geocode({
      location: marker.getPosition()
    }, function (results, status) {
      geocodeResults(results, status, marker.getPosition());
    });
  });

  initAutocomplete();
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJfc3JjL2pzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7O0FDRUEsT0FBTyxZQUFQLEdBQXNCLFNBQVMsWUFBVCxDQUNsQixrQkFEa0IsRUFFbEIsS0FGa0IsRUFHbEIsS0FIa0IsRUFJbEIsS0FKa0IsRUFLbEIsUUFMa0IsRUFNbEIsTUFOa0IsRUFPbEIsT0FQa0IsRUFRbEIsU0FSa0IsRUFTbEIsS0FUa0IsRUFVbEIsVUFWa0IsRUFXbEIsVUFYa0IsRUFZcEI7QUFDQSxNQUFNLHFCQUFxQixTQUFTLGNBQVQsQ0FBd0Isa0JBQXhCLENBQXJCLENBRE47QUFFQSxNQUFNLFFBQVEsU0FBUyxjQUFULENBQXdCLEtBQXhCLENBQVIsQ0FGTjtBQUdBLE1BQU0sUUFBUSxTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsQ0FBUixDQUhOO0FBSUEsTUFBTSxRQUFRLFNBQVMsY0FBVCxDQUF3QixLQUF4QixDQUFSLENBSk47QUFLQSxNQUFNLFdBQVcsU0FBUyxjQUFULENBQXdCLFFBQXhCLENBQVgsQ0FMTjtBQU1BLE1BQU0sU0FBUyxTQUFTLGNBQVQsQ0FBd0IsTUFBeEIsQ0FBVCxDQU5OO0FBT0EsTUFBTSxVQUFVLFNBQVMsY0FBVCxDQUF3QixPQUF4QixDQUFWLENBUE47QUFRQSxNQUFNLFlBQVksU0FBUyxjQUFULENBQXdCLFNBQXhCLENBQVosQ0FSTjtBQVNBLE1BQU0sUUFBUSxTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsQ0FBUixDQVROO0FBVUEsTUFBTSxXQUFXLElBQUksT0FBTyxJQUFQLENBQVksUUFBWixFQUFmLENBVk47QUFXQSxNQUFNLGdCQUFnQjtBQUNwQixtQkFBZSxZQUFmO0FBQ0EsV0FBTyxXQUFQO0FBQ0EsY0FBVSxXQUFWO0FBQ0EsaUNBQTZCLFlBQTdCO0FBQ0EsYUFBUyxXQUFUO0FBQ0EsaUJBQWEsWUFBYjtHQU5JLENBWE47QUFtQkEsTUFBSSxxQkFB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QUFTLE9BQVQsQ0FBaUI7QUFDZixnQkFBVSxPQUFPLFdBQVAsRUFBVjtLQURGLEVBRUcsVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUN0QixxQkFBZSxPQUFmLEVBQXdCLE1BQXhCLEVBQWdDLE9BQU8sV0FBUCxFQUFoQyxFQURzQjtLQUFyQixDQUZILENBRHFEO0dBQU4sQ0FBakQsQ0F0SEE7O0FBOEhBLHFCQTlIQTtDQVpvQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKiBnbG9iYWwgZ29vZ2xlICovXG5cbndpbmRvdy5nb29nbGVNYXBpZnkgPSBmdW5jdGlvbiBnb29nbGVNYXBpZnkoXG4gICAgZm9ybWF0dGVkQWRkcmVzc0lkLFxuICAgIG1hcElkLFxuICAgIGxhdElkLFxuICAgIGxuZ0lkLFxuICAgIHN0cmVldElkLFxuICAgIGNpdHlJZCxcbiAgICBzdGF0ZUlkLFxuICAgIGNvdW50cnlJZCxcbiAgICB6aXBJZCxcbiAgICBkZWZhdWx0TGF0LFxuICAgIGRlZmF1bHRMbmdcbikge1xuICBjb25zdCBmb3JtYXR0ZWRBZGRyZXNzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmb3JtYXR0ZWRBZGRyZXNzSWQpO1xuICBjb25zdCBtYXBFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1hcElkKTtcbiAgY29uc3QgbGF0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsYXRJZCk7XG4gIGNvbnN0IGxuZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobG5nSWQpO1xuICBjb25zdCBzdHJlZXRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0cmVldElkKTtcbiAgY29uc3QgY2l0eUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2l0eUlkKTtcbiAgY29uc3Qgc3RhdGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0YXRlSWQpO1xuICBjb25zdCBjb3VudHJ5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3VudHJ5SWQpO1xuICBjb25zdCB6aXBFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHppcElkKTtcbiAgY29uc3QgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgY29uc3QgY29tcG9uZW50Rm9ybSA9IHtcbiAgICBzdHJlZXRfbnVtYmVyOiAnc2hvcnRfbmFtZScsXG4gICAgcm91dGU6ICdsb25nX25hbWUnLFxuICAgIGxvY2FsaXR5OiAnbG9uZ19uYW1lJyxcbiAgICBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzE6ICdzaG9ydF9uYW1lJyxcbiAgICBjb3VudHJ5OiAnbG9uZ19uYW1lJyxcbiAgICBwb3N0YWxfY29kZTogJ3Nob3J0X25hbWUnLFxuICB9O1xuICBsZXQgYXV0b2NvbXBsZXRlO1xuICBsZXQgbWFwQ2VudGVyO1xuICBsZXQgem9vbTtcblxuICBpZiAoISFsYXRFbC52YWx1ZSAmJiAhIWxuZ0VsLnZhbHVlKSB7XG4gICAgbWFwQ2VudGVyID0ge1xuICAgICAgbGF0OiBwYXJzZUZsb2F0KGxhdEVsLnZhbHVlKSxcbiAgICAgIGxuZzogcGFyc2VGbG9hdChsbmdFbC52YWx1ZSksXG4gICAgfTtcbiAgICB6b29tID0gMTI7XG4gIH0gZWxzZSB7XG4gICAgbWFwQ2VudGVyID0ge1xuICAgICAgbGF0OiBwYXJzZUZsb2F0KGRlZmF1bHRMYXQpLFxuICAgICAgbG5nOiBwYXJzZUZsb2F0KGRlZmF1bHRMbmcpLFxuICAgIH07XG4gICAgem9vbSA9IDQ7XG4gIH1cblxuICBjb25zdCBtYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKG1hcEVsLCB7XG4gICAgY2VudGVyOiBtYXBDZW50ZXIsXG4gICAgem9vbSxcbiAgfSk7XG5cbiAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgbWFwLFxuICAgIGRyYWdnYWJsZTogdHJ1ZSxcbiAgICBwb3NpdGlvbjogbWFwQ2VudGVyLFxuICB9KTtcblxuICBjb25zdCB1cGRhdGVWYWx1ZXMgPSBmdW5jdGlvbiB1cGRhdGVWYWx1ZXMobGF0LCBsbmcsIGFkZHJlc3NDb21wb25lbnRzKSB7XG4gICAgbGF0RWwudmFsdWUgPSBsYXQ7XG4gICAgbG5nRWwudmFsdWUgPSBsbmc7XG5cbiAgICBpZiAoISFhZGRyZXNzQ29tcG9uZW50cykge1xuICAgICAgc3RyZWV0RWwudmFsdWUgPSAhIWFkZHJlc3NDb21wb25lbnRzLnN0cmVldF9udW1iZXIgPyBhZGRyZXNzQ29tcG9uZW50cy5zdHJlZXRfbnVtYmVyIDogJyc7XG4gICAgICBzdHJlZXRFbC52YWx1ZSArPSAhIWFkZHJlc3NDb21wb25lbnRzLnJvdXRlID8gYCAke2FkZHJlc3NDb21wb25lbnRzLnJvdXRlfWAgOiAnJztcbiAgICAgIGNpdHlFbC52YWx1ZSA9ICEhYWRkcmVzc0NvbXBvbmVudHMubG9jYWxpdHkgPyBhZGRyZXNzQ29tcG9uZW50cy5sb2NhbGl0eSA6ICcnO1xuICAgICAgc3RhdGVFbC52YWx1ZSA9ICEhYWRkcmVzc0NvbXBvbmVudHMuYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xID9cbiAgICAgICAgYWRkcmVzc0NvbXBvbmVudHMuYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xIDogJyc7XG4gICAgICBjb3VudHJ5RWwudmFsdWUgPSAhIWFkZHJlc3NDb21wb25lbnRzLmNvdW50cnkgPyBhZGRyZXNzQ29tcG9uZW50cy5jb3VudHJ5IDogJyc7XG4gICAgICB6aXBFbC52YWx1ZSA9ICEhYWRkcmVzc0NvbXBvbmVudHMucG9zdGFsX2NvZGUgPyBhZGRyZXNzQ29tcG9uZW50cy5wb3N0YWxfY29kZSA6ICcnO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBnZW9jb2RlUmVzdWx0cyA9IGZ1bmN0aW9uIGdlb2NvZGVSZXN1bHRzKHJlc3VsdHMsIHN0YXR1cywgZ2l2ZW5Mb2NhdGlvbikge1xuICAgIGlmIChzdGF0dXMgPT09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LICYmICEhcmVzdWx0c1swXSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gcmVzdWx0c1swXTtcbiAgICAgIGNvbnN0IGxvY2F0aW9uID0gISFnaXZlbkxvY2F0aW9uID8gZ2l2ZW5Mb2NhdGlvbiA6IHJlc3VsdC5nZW9tZXRyeS5sb2NhdGlvbjtcblxuICAgICAgbWFwLmZpdEJvdW5kcyhyZXN1bHQuZ2VvbWV0cnkudmlld3BvcnQpO1xuICAgICAgbWFwLnNldENlbnRlcihsb2NhdGlvbik7XG4gICAgICBtYXJrZXIuc2V0UG9zaXRpb24obG9jYXRpb24pO1xuXG4gICAgICB1cGRhdGVWYWx1ZXMoXG4gICAgICAgICAgbG9jYXRpb24ubGF0KCksXG4gICAgICAgICAgbG9jYXRpb24ubG5nKClcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFsZXJ0KGBHZW9jb2RlIHdhcyBub3Qgc3VjY2Vzc2Z1bCBmb3IgdGhlIGZvbGxvd2luZyByZWFzb246ICR7c3RhdHVzfWApO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBvblByZWRpY3Rpb25TZWxlY3Rpb24gPSBmdW5jdGlvbiBvblByZWRpY3Rpb25TZWxlY3Rpb24oKSB7XG4gICAgY29uc3QgcGxhY2UgPSBhdXRvY29tcGxldGUuZ2V0UGxhY2UoKTtcbiAgICBjb25zdCBhZGRyZXNzQ29tcG9uZW50cyA9IHt9O1xuXG4gICAgLy8gR2V0IGVhY2ggY29tcG9uZW50IG9mIHRoZSBhZGRyZXNzIGZyb20gdGhlIHBsYWNlIGRldGFpbHNcbiAgICAvLyBhbmQgZmlsbCB0aGUgY29ycmVzcG9uZGluZyBmaWVsZCBvbiB0aGUgZm9ybS5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHBsYWNlLmFkZHJlc3NfY29tcG9uZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgYWRkcmVzc1R5cGUgPSBwbGFjZS5hZGRyZXNzX2NvbXBvbmVudHNbaV0udHlwZXNbMF07XG4gICAgICBpZiAoY29tcG9uZW50Rm9ybVthZGRyZXNzVHlwZV0pIHtcbiAgICAgICAgY29uc3QgdmFsID0gcGxhY2UuYWRkcmVzc19jb21wb25lbnRzW2ldW2NvbXBvbmVudEZvcm1bYWRkcmVzc1R5cGVdXTtcbiAgICAgICAgYWRkcmVzc0NvbXBvbmVudHNbYWRkcmVzc1R5cGVdID0gdmFsO1xuICAgICAgfVxuICAgIH1cblxuICAgIHVwZGF0ZVZhbHVlcyhcbiAgICAgIHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxhdCgpLFxuICAgICAgcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubG5nKCksXG4gICAgICBhZGRyZXNzQ29tcG9uZW50c1xuICAgICk7XG4gICAgY29uc29sZS5sb2coYWRkcmVzc0NvbXBvbmVudHMpO1xuXG4gICAgbWFwLnNldENlbnRlcihwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gICAgbWFwLnNldFpvb20oMTUpO1xuICAgIG1hcmtlci5zZXRQb3NpdGlvbihwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gIH07XG5cbiAgY29uc3QgaW5pdEF1dG9jb21wbGV0ZSA9IGZ1bmN0aW9uIGluaXRBdXRvY29tcGxldGUoKSB7XG4gICAgLy8gQ3JlYXRlIHRoZSBhdXRvY29tcGxldGUgb2JqZWN0LCByZXN0cmljdGluZyB0aGUgc2VhcmNoIHRvIGdlb2dyYXBoaWNhbCBsb2NhdGlvbiB0eXBlcy5cbiAgICBhdXRvY29tcGxldGUgPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLkF1dG9jb21wbGV0ZShcbiAgICAgICAgZm9ybWF0dGVkQWRkcmVzc0VsLFxuICAgICAgICB7IHR5cGVzOiBbJ2dlb2NvZGUnXSB9XG4gICAgKTtcblxuICAgIC8vIFdoZW4gdGhlIHVzZXIgc2VsZWN0cyBhbiBhZGRyZXNzIGZyb20gdGhlIGRyb3Bkb3duLCBwb3B1bGF0ZSB0aGUgYWRkcmVzcyBmaWVsZHMgaW4gdGhlIGZvcm0uXG4gICAgYXV0b2NvbXBsZXRlLmFkZExpc3RlbmVyKCdwbGFjZV9jaGFuZ2VkJywgb25QcmVkaWN0aW9uU2VsZWN0aW9uKTtcbiAgfTtcblxuICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdkcmFnZW5kJywgKCkgPT4ge1xuICAgIGdlb2NvZGVyLmdlb2NvZGUoe1xuICAgICAgbG9jYXRpb246IG1hcmtlci5nZXRQb3NpdGlvbigpLFxuICAgIH0sIChyZXN1bHRzLCBzdGF0dXMpID0+IHtcbiAgICAgIGdlb2NvZGVSZXN1bHRzKHJlc3VsdHMsIHN0YXR1cywgbWFya2VyLmdldFBvc2l0aW9uKCkpO1xuICAgIH0pO1xuICB9KTtcblxuICBpbml0QXV0b2NvbXBsZXRlKCk7XG59O1xuIl19

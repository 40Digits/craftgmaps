(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

/* global google */

// TODO refactor needed - it even affects the js
window.googleMapify = function googleMapify(formattedAddressId, mapId, zoomId, latId, lngId, streetId, cityId, stateId, countryId, zipId) {
  // TODO refactor needed - it's here too
  var formattedAddressEl = document.getElementById(formattedAddressId);
  var mapEl = document.getElementById(mapId);
  var zoomEl = document.getElementById(zoomId);
  var latEl = document.getElementById(latId);
  var lngEl = document.getElementById(lngId);
  var streetEl = document.getElementById(streetId);
  var cityEl = document.getElementById(cityId);
  var stateEl = document.getElementById(stateId);
  var countryEl = document.getElementById(countryId);
  var zipEl = document.getElementById(zipId);
  var geocoder = new google.maps.Geocoder();
  var componentForm = {
    street_number: 'short_name',
    route: 'long_name',
    locality: 'long_name',
    administrative_area_level_1: 'short_name',
    country: 'long_name',
    postal_code: 'short_name'
  };
  var autocomplete = void 0;

  var mapCenter = {
    lat: parseFloat(latEl.value),
    lng: parseFloat(lngEl.value)
  };
  var zoom = parseInt(zoomEl.value, 0);

  var map = new google.maps.Map(mapEl, {
    center: mapCenter,
    zoom: zoom,
    scrollwheel: false,
    navigationControl: false,
    mapTypeControl: false,
    scaleControl: false,
    draggable: true
  });

  var marker = new google.maps.Marker({
    map: map,
    draggable: true,
    position: mapCenter
  });

  var updateValues = function updateValues(lat, lng, addressComponents) {
    latEl.value = lat;
    lngEl.value = lng;
    zoomEl.value = map.getZoom();

    if (!!addressComponents) {
      streetEl.value = !!addressComponents.street_number ? addressComponents.street_number : '';
      streetEl.value += !!addressComponents.route ? ' ' + addressComponents.route : '';
      cityEl.value = !!addressComponents.locality ? addressComponents.locality : '';
      stateEl.value = !!addressComponents.administrative_area_level_1 ? addressComponents.administrative_area_level_1 : '';
      countryEl.value = !!addressComponents.country ? addressComponents.country : '';
      zipEl.value = !!addressComponents.postal_code ? addressComponents.postal_code : '';
    }
  };

  var geocodeResults = function geocodeResults(results, status, givenLocation) {
    if (status === google.maps.GeocoderStatus.OK && !!results[0]) {
      var result = results[0];
      var location = !!givenLocation ? givenLocation : result.geometry.location;

      map.fitBounds(result.geometry.viewport);
      map.setCenter(location);
      marker.setPosition(location);

      updateValues(location.lat(), location.lng());
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  };

  var onPredictionSelection = function onPredictionSelection() {
    var place = autocomplete.getPlace();
    var addressComponents = {};

    // Get each component of the address from the place details
    // and fill the corresponding field on the form.
    for (var i = 0; i < place.address_components.length; i++) {
      var addressType = place.address_components[i].types[0];
      if (componentForm[addressType]) {
        var val = place.address_components[i][componentForm[addressType]];
        addressComponents[addressType] = val;
      }
    }

    updateValues(place.geometry.location.lat(), place.geometry.location.lng(), addressComponents);

    map.setCenter(place.geometry.location);
    map.setZoom(15);
    marker.setPosition(place.geometry.location);
  };

  var initAutocomplete = function initAutocomplete() {
    // Create the autocomplete object, restricting the search to geographical location types.
    autocomplete = new google.maps.places.Autocomplete(formattedAddressEl, { types: ['geocode'] });

    // When the user selects an address from the dropdown, populate the address fields in the form.
    autocomplete.addListener('place_changed', onPredictionSelection);
  };

  google.maps.event.addListener(marker, 'dragend', function () {
    geocoder.geocode({
      location: marker.getPosition()
    }, function (results, status) {
      geocodeResults(results, status, marker.getPosition());
    });
  });

  google.maps.event.addListener(map, 'zoom_changed', function () {
    console.log(map.getZoom());
    zoomEl.value = map.getZoom();
  });

  initAutocomplete();
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJfc3JjL2pzL21haW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7OztBQ0dBLE9BQU8sWUFBUCxHQUFzQixTQUFTLFlBQVQsQ0FDbEIsa0JBRGtCLEVBRWxCLEtBRmtCLEVBR2xCLE1BSGtCLEVBSWxCLEtBSmtCLEVBS2xCLEtBTGtCLEVBTWxCLFFBTmtCLEVBT2xCLE1BUGtCLEVBUWxCLE9BUmtCLEVBU2xCLFNBVGtCLEVBVWxCLEtBVmtCLEVBV3BCOztBQUVBLE1BQU0scUJBQXFCLFNBQVMsY0FBVCxDQUF3QixrQkFBeEIsQ0FBckIsQ0FGTjtBQUdBLE1BQU0sUUFBUSxTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsQ0FBUixDQUhOO0FBSUEsTUFBTSxTQUFTLFNBQVMsY0FBVCxDQUF3QixNQUF4QixDQUFULENBSk47QUFLQSxNQUFNLFFBQVEsU0FBUyxjQUFULENBQXdCLEtBQXhCLENBQVIsQ0FMTjtBQU1BLE1BQU0sUUFBUSxTQUFTLGNBQVQsQ0FBd0IsS0FBeEIsQ0FBUixDQU5OO0FBT0EsTUFBTSxXQUFXLFNBQVMsY0FBVCxDQUF3QixRQUF4QixDQUFYLENBUE47QUFRQSxNQUFNLFNBQVMsU0FBUyxjQUFULENBQXdCLE1BQXhCLENBQVQsQ0FSTjtBQVNBLE1BQU0sVUFBVSxTQUFTLGNBQVQsQ0FBd0IsT0FBeEIsQ0FBVixDQVROO0FBVUEsTUFBTSxZQUFZLFNBQVMsY0FBVCxDQUF3QixTQUF4QixDQUFaLENBVk47QUFXQSxNQUFNLFFBQVEsU0FBUyxjQUFULENBQXdCLEtBQXhCLENBQVIsQ0FYTjtBQVlBLE1BQU0sV0FBVyxJQUFJLE9BQU8sSUFBUCxDQUFZLFFBQVosRUFBZixDQVpOO0FBYUEsTUFBTSxnQkFBZ0I7QUFDcEIsbUJBQWUsWUFBZjtBQUNBLFdBQU8sV0FBUDtBQUNBLGNBQVUsV0FBVjtBQUNBLGlDQUE2QixZQUE3QjtBQUNBLGFBQVMsV0FBVDtBQUNB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RyxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQXFCO0FBQ3RCLHFCQUFlLE9BQWYsRUFBd0IsTUFBeEIsRUFBZ0MsT0FBTyxXQUFQLEVBQWhDLEVBRHNCO0tBQXJCLENBRkgsQ0FEcUQ7R0FBTixDQUFqRCxDQW5IQTs7QUEySEEsU0FBTyxJQUFQLENBQVksS0FBWixDQUFrQixXQUFsQixDQUE4QixHQUE5QixFQUFtQyxjQUFuQyxFQUFtRCxZQUFNO0FBQ3ZELFlBQVEsR0FBUixDQUFZLElBQUksT0FBSixFQUFaLEVBRHVEO0FBRXZELFdBQU8sS0FBUCxHQUFlLElBQUksT0FBSixFQUFmLENBRnVEO0dBQU4sQ0FBbkQsQ0EzSEE7O0FBZ0lBLHFCQWhJQTtDQVhvQiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKiBnbG9iYWwgZ29vZ2xlICovXG5cbi8vIFRPRE8gcmVmYWN0b3IgbmVlZGVkIC0gaXQgZXZlbiBhZmZlY3RzIHRoZSBqc1xud2luZG93Lmdvb2dsZU1hcGlmeSA9IGZ1bmN0aW9uIGdvb2dsZU1hcGlmeShcbiAgICBmb3JtYXR0ZWRBZGRyZXNzSWQsXG4gICAgbWFwSWQsXG4gICAgem9vbUlkLFxuICAgIGxhdElkLFxuICAgIGxuZ0lkLFxuICAgIHN0cmVldElkLFxuICAgIGNpdHlJZCxcbiAgICBzdGF0ZUlkLFxuICAgIGNvdW50cnlJZCxcbiAgICB6aXBJZFxuKSB7XG4gIC8vIFRPRE8gcmVmYWN0b3IgbmVlZGVkIC0gaXQncyBoZXJlIHRvb1xuICBjb25zdCBmb3JtYXR0ZWRBZGRyZXNzRWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChmb3JtYXR0ZWRBZGRyZXNzSWQpO1xuICBjb25zdCBtYXBFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKG1hcElkKTtcbiAgY29uc3Qgem9vbUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoem9vbUlkKTtcbiAgY29uc3QgbGF0RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChsYXRJZCk7XG4gIGNvbnN0IGxuZ0VsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobG5nSWQpO1xuICBjb25zdCBzdHJlZXRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0cmVldElkKTtcbiAgY29uc3QgY2l0eUVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoY2l0eUlkKTtcbiAgY29uc3Qgc3RhdGVFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHN0YXRlSWQpO1xuICBjb25zdCBjb3VudHJ5RWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb3VudHJ5SWQpO1xuICBjb25zdCB6aXBFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHppcElkKTtcbiAgY29uc3QgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgY29uc3QgY29tcG9uZW50Rm9ybSA9IHtcbiAgICBzdHJlZXRfbnVtYmVyOiAnc2hvcnRfbmFtZScsXG4gICAgcm91dGU6ICdsb25nX25hbWUnLFxuICAgIGxvY2FsaXR5OiAnbG9uZ19uYW1lJyxcbiAgICBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzE6ICdzaG9ydF9uYW1lJyxcbiAgICBjb3VudHJ5OiAnbG9uZ19uYW1lJyxcbiAgICBwb3N0YWxfY29kZTogJ3Nob3J0X25hbWUnLFxuICB9O1xuICBsZXQgYXV0b2NvbXBsZXRlO1xuXG4gIGNvbnN0IG1hcENlbnRlciA9IHtcbiAgICBsYXQ6IHBhcnNlRmxvYXQobGF0RWwudmFsdWUpLFxuICAgIGxuZzogcGFyc2VGbG9hdChsbmdFbC52YWx1ZSksXG4gIH07XG4gIGNvbnN0IHpvb20gPSBwYXJzZUludCh6b29tRWwudmFsdWUsIDApO1xuXG4gIGNvbnN0IG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAobWFwRWwsIHtcbiAgICBjZW50ZXI6IG1hcENlbnRlcixcbiAgICB6b29tLFxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZSxcbiAgICBuYXZpZ2F0aW9uQ29udHJvbDogZmFsc2UsXG4gICAgbWFwVHlwZUNvbnRyb2w6IGZhbHNlLFxuICAgIHNjYWxlQ29udHJvbDogZmFsc2UsXG4gICAgZHJhZ2dhYmxlOiB0cnVlLFxuICB9KTtcblxuICBjb25zdCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICBtYXAsXG4gICAgZHJhZ2dhYmxlOiB0cnVlLFxuICAgIHBvc2l0aW9uOiBtYXBDZW50ZXIsXG4gIH0pO1xuXG4gIGNvbnN0IHVwZGF0ZVZhbHVlcyA9IGZ1bmN0aW9uIHVwZGF0ZVZhbHVlcyhsYXQsIGxuZywgYWRkcmVzc0NvbXBvbmVudHMpIHtcbiAgICBsYXRFbC52YWx1ZSA9IGxhdDtcbiAgICBsbmdFbC52YWx1ZSA9IGxuZztcbiAgICB6b29tRWwudmFsdWUgPSBtYXAuZ2V0Wm9vbSgpO1xuXG4gICAgaWYgKCEhYWRkcmVzc0NvbXBvbmVudHMpIHtcbiAgICAgIHN0cmVldEVsLnZhbHVlID0gISFhZGRyZXNzQ29tcG9uZW50cy5zdHJlZXRfbnVtYmVyID8gYWRkcmVzc0NvbXBvbmVudHMuc3RyZWV0X251bWJlciA6ICcnO1xuICAgICAgc3RyZWV0RWwudmFsdWUgKz0gISFhZGRyZXNzQ29tcG9uZW50cy5yb3V0ZSA/IGAgJHthZGRyZXNzQ29tcG9uZW50cy5yb3V0ZX1gIDogJyc7XG4gICAgICBjaXR5RWwudmFsdWUgPSAhIWFkZHJlc3NDb21wb25lbnRzLmxvY2FsaXR5ID8gYWRkcmVzc0NvbXBvbmVudHMubG9jYWxpdHkgOiAnJztcbiAgICAgIHN0YXRlRWwudmFsdWUgPSAhIWFkZHJlc3NDb21wb25lbnRzLmFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSA/XG4gICAgICAgIGFkZHJlc3NDb21wb25lbnRzLmFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSA6ICcnO1xuICAgICAgY291bnRyeUVsLnZhbHVlID0gISFhZGRyZXNzQ29tcG9uZW50cy5jb3VudHJ5ID8gYWRkcmVzc0NvbXBvbmVudHMuY291bnRyeSA6ICcnO1xuICAgICAgemlwRWwudmFsdWUgPSAhIWFkZHJlc3NDb21wb25lbnRzLnBvc3RhbF9jb2RlID8gYWRkcmVzc0NvbXBvbmVudHMucG9zdGFsX2NvZGUgOiAnJztcbiAgICB9XG4gIH07XG5cbiAgY29uc3QgZ2VvY29kZVJlc3VsdHMgPSBmdW5jdGlvbiBnZW9jb2RlUmVzdWx0cyhyZXN1bHRzLCBzdGF0dXMsIGdpdmVuTG9jYXRpb24pIHtcbiAgICBpZiAoc3RhdHVzID09PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSyAmJiAhIXJlc3VsdHNbMF0pIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHJlc3VsdHNbMF07XG4gICAgICBjb25zdCBsb2NhdGlvbiA9ICEhZ2l2ZW5Mb2NhdGlvbiA/IGdpdmVuTG9jYXRpb24gOiByZXN1bHQuZ2VvbWV0cnkubG9jYXRpb247XG5cbiAgICAgIG1hcC5maXRCb3VuZHMocmVzdWx0Lmdlb21ldHJ5LnZpZXdwb3J0KTtcbiAgICAgIG1hcC5zZXRDZW50ZXIobG9jYXRpb24pO1xuICAgICAgbWFya2VyLnNldFBvc2l0aW9uKGxvY2F0aW9uKTtcblxuICAgICAgdXBkYXRlVmFsdWVzKFxuICAgICAgICAgIGxvY2F0aW9uLmxhdCgpLFxuICAgICAgICAgIGxvY2F0aW9uLmxuZygpXG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBhbGVydChgR2VvY29kZSB3YXMgbm90IHN1Y2Nlc3NmdWwgZm9yIHRoZSBmb2xsb3dpbmcgcmVhc29uOiAke3N0YXR1c31gKTtcbiAgICB9XG4gIH07XG5cbiAgY29uc3Qgb25QcmVkaWN0aW9uU2VsZWN0aW9uID0gZnVuY3Rpb24gb25QcmVkaWN0aW9uU2VsZWN0aW9uKCkge1xuICAgIGNvbnN0IHBsYWNlID0gYXV0b2NvbXBsZXRlLmdldFBsYWNlKCk7XG4gICAgY29uc3QgYWRkcmVzc0NvbXBvbmVudHMgPSB7fTtcblxuICAgIC8vIEdldCBlYWNoIGNvbXBvbmVudCBvZiB0aGUgYWRkcmVzcyBmcm9tIHRoZSBwbGFjZSBkZXRhaWxzXG4gICAgLy8gYW5kIGZpbGwgdGhlIGNvcnJlc3BvbmRpbmcgZmllbGQgb24gdGhlIGZvcm0uXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbGFjZS5hZGRyZXNzX2NvbXBvbmVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGFkZHJlc3NUeXBlID0gcGxhY2UuYWRkcmVzc19jb21wb25lbnRzW2ldLnR5cGVzWzBdO1xuICAgICAgaWYgKGNvbXBvbmVudEZvcm1bYWRkcmVzc1R5cGVdKSB7XG4gICAgICAgIGNvbnN0IHZhbCA9IHBsYWNlLmFkZHJlc3NfY29tcG9uZW50c1tpXVtjb21wb25lbnRGb3JtW2FkZHJlc3NUeXBlXV07XG4gICAgICAgIGFkZHJlc3NDb21wb25lbnRzW2FkZHJlc3NUeXBlXSA9IHZhbDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB1cGRhdGVWYWx1ZXMoXG4gICAgICBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sYXQoKSxcbiAgICAgIHBsYWNlLmdlb21ldHJ5LmxvY2F0aW9uLmxuZygpLFxuICAgICAgYWRkcmVzc0NvbXBvbmVudHNcbiAgICApO1xuXG4gICAgbWFwLnNldENlbnRlcihwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gICAgbWFwLnNldFpvb20oMTUpO1xuICAgIG1hcmtlci5zZXRQb3NpdGlvbihwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG4gIH07XG5cbiAgY29uc3QgaW5pdEF1dG9jb21wbGV0ZSA9IGZ1bmN0aW9uIGluaXRBdXRvY29tcGxldGUoKSB7XG4gICAgLy8gQ3JlYXRlIHRoZSBhdXRvY29tcGxldGUgb2JqZWN0LCByZXN0cmljdGluZyB0aGUgc2VhcmNoIHRvIGdlb2dyYXBoaWNhbCBsb2NhdGlvbiB0eXBlcy5cbiAgICBhdXRvY29tcGxldGUgPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLkF1dG9jb21wbGV0ZShcbiAgICAgICAgZm9ybWF0dGVkQWRkcmVzc0VsLFxuICAgICAgICB7IHR5cGVzOiBbJ2dlb2NvZGUnXSB9XG4gICAgKTtcblxuICAgIC8vIFdoZW4gdGhlIHVzZXIgc2VsZWN0cyBhbiBhZGRyZXNzIGZyb20gdGhlIGRyb3Bkb3duLCBwb3B1bGF0ZSB0aGUgYWRkcmVzcyBmaWVsZHMgaW4gdGhlIGZvcm0uXG4gICAgYXV0b2NvbXBsZXRlLmFkZExpc3RlbmVyKCdwbGFjZV9jaGFuZ2VkJywgb25QcmVkaWN0aW9uU2VsZWN0aW9uKTtcbiAgfTtcblxuICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdkcmFnZW5kJywgKCkgPT4ge1xuICAgIGdlb2NvZGVyLmdlb2NvZGUoe1xuICAgICAgbG9jYXRpb246IG1hcmtlci5nZXRQb3NpdGlvbigpLFxuICAgIH0sIChyZXN1bHRzLCBzdGF0dXMpID0+IHtcbiAgICAgIGdlb2NvZGVSZXN1bHRzKHJlc3VsdHMsIHN0YXR1cywgbWFya2VyLmdldFBvc2l0aW9uKCkpO1xuICAgIH0pO1xuICB9KTtcblxuICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXAsICd6b29tX2NoYW5nZWQnLCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2cobWFwLmdldFpvb20oKSk7XG4gICAgem9vbUVsLnZhbHVlID0gbWFwLmdldFpvb20oKTtcbiAgfSk7XG5cbiAgaW5pdEF1dG9jb21wbGV0ZSgpO1xufTtcbiJdfQ==
